<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>èˆ†æƒ…æ ‡ç­¾è‡ªåŠ¨åŒ–åˆ†ç±»æ™ºèƒ½ä½“</title>
  <style>
    /* å…¨å±€é‡ç½®ä¸åŸºç¡€æ ·å¼ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: "Helvetica Neue", Arial, Helvetica, sans-serif;
      background-color: #f4f6f8;
      color: #333;
      line-height: 1.6;
    }
    a {
      color: inherit;
      text-decoration: none;
    }
    /* ä¸»å®¹å™¨å æ»¡å…¨å®½ */
    .container {
      width: 100%;
      margin: 0 auto;
    }
    /* é¡¶éƒ¨å¯¼èˆª/æ ‡é¢˜ */
    header.top-nav {
      width: 100%;
      background-color: #fff;
      border-bottom: 1px solid #e1e4e8;
      padding: 16px 40px; /* å·¦å³å¢åŠ å†…è¾¹è· */
      display: flex;
      align-items: center;
    }
    header.top-nav .logo {
      width: 36px;
      height: 36px;
      background-color: #409eff;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: bold;
      font-size: 1.2rem;
    }
    header.top-nav h2 {
      font-size: 1.5rem;
      color: #2c3e50;
      margin-left: 12px;
    }
    /* è½®æ’­/é¡¶éƒ¨å¤§æ¨ªå¹…åŒºåŸŸ */
    .hero {
      width: 100%;
      background-color: #409eff;
      color: #fff;
      padding: 80px 40px; /* å·¦å³å†…è¾¹è·40 */
      text-align: center;
      border-radius: 0 0 8px 8px;
      margin-top: 0;
    }
    .hero h1 {
      font-size: 2.5rem;
      margin-bottom: 16px;
    }
    .hero p {
      font-size: 1.1rem;
      margin-bottom: 24px;
    }
    /* Hero ä¸‹æ–¹çš„å››ä¸ªåœ†è§’æŒ‰é’® */
    .hero .pill-buttons {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 16px;
    }
    .hero .pill-buttons .pill {
      background-color: rgba(255, 255, 255, 0.15);
      color: #fff;
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: background-color 0.2s ease;
      cursor: default;
    }
    .hero .pill-buttons .pill:hover {
      background-color: rgba(255, 255, 255, 0.25);
    }
    .hero .pill-buttons .pill .icon {
      font-size: 1.2rem;
    }
    /* åŠŸèƒ½ç‰¹è‰² */
    .features {
      display: flex;
      justify-content: space-around;
      margin-top: -20px; /* è®© features ä¸ hero åº•éƒ¨æ— ç¼è¡”æ¥ */
      flex-wrap: wrap;
      gap: 20px;
      padding: 20px 40px; /* å·¦å³å†…è¾¹è·40 */
      background-color: #f4f6f8;
    }
    .feature-card {
      background-color: #fff;
      flex: 1 1 calc(25% - 40px);
      min-width: 200px;
      margin-top: 20px;
      padding: 24px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      text-align: center;
    }
    .feature-card .icon {
      font-size: 2rem;
      margin-bottom: 12px;
      color: #409eff;
    }
    .feature-card h3 {
      font-size: 1.2rem;
      margin-bottom: 8px;
      color: #2c3e50;
    }
    .feature-card p {
      font-size: 0.95rem;
      color: #555;
    }
    /* æµç¨‹å±•ç¤º */
    .process {
      margin: 60px 0 20px;
      text-align: center;
      padding: 0 40px; /* å·¦å³å†…è¾¹è·40 */
    }
    .process h2 {
      font-size: 2rem;
      color: #2c3e50;
      margin-bottom: 24px;
    }
    .steps {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      gap: 20px;
    }
    .step-card {
      background-color: #fff;
      flex: 1 1 calc(25% - 40px);
      min-width: 200px;
      padding: 24px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      text-align: center;
    }
    .step-card .icon {
      font-size: 2rem;
      margin-bottom: 12px;
      color: #409eff;
    }
    .step-card h3 {
      font-size: 1.15rem;
      margin-bottom: 8px;
      color: #2c3e50;
    }
    .step-card p {
      font-size: 0.9rem;
      color: #555;
    }
    /* ç”¨æˆ·æŒ‡ä»¤ä¸ä¸Šä¼ è¡¨å• */
    /* å°† instruction-section å®½åº¦è®¾ä¸º 80% å¹¶å±…ä¸­ */
    .instruction-section {
      background-color: #fff;
      width: 80%;
      margin: 40px auto; /* ä¸Šä¸‹ 40pxï¼Œå·¦å³è‡ªåŠ¨å±…ä¸­ */
      padding: 32px 40px; /* å·¦å³å†…è¾¹è·40 */
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    .instruction-section h2 {
      font-size: 1.75rem;
      margin-bottom: 8px;
      color: #2c3e50;
      text-align: center;
    }
    .instruction-section p.subtitle {
      font-size: 1rem;
      color: #666;
      text-align: center;
      margin-bottom: 24px;
    }
    .instruction-section .field {
      margin-bottom: 24px;
      position: relative;
    }
    .instruction-section .field label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: #2c3e50;
    }
    .instruction-section .field input[type="file"],
    .instruction-section .field input[type="text"],
    .instruction-section .field textarea {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid #d1d9e0;
      border-radius: 6px;
      font-size: 1rem;
      background-color: #fafbfc;
      transition: border-color 0.2s ease;
    }
    .instruction-section .field textarea {
      resize: vertical;
      min-height: 100px;
    }
    .instruction-section .field input[type="text"]:focus,
    .instruction-section .field textarea:focus {
      border-color: #409eff;
      outline: none;
      background-color: #fff;
    }
    /* ç¤ºä¾‹æŒ‡ä»¤å¡ç‰‡ */
    .example-container {
      position: relative;
      background-color: #f1f3f5;
      padding: 12px 16px;
      border-left: 4px solid #409eff;
      margin-bottom: 24px;
      border-radius: 4px;
      font-size: 0.95rem;
      color: #555;
      line-height: 1.4;
    }
    .example-container pre {
      margin: 0;
      background: none;
      padding: 0;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .copy-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background-color: #409eff;
      border: none;
      border-radius: 4px;
      padding: 4px 10px;
      font-size: 0.85rem;
      color: #fff;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }
    .copy-btn:hover {
      background-color: #357cd2;
    }
    /* æäº¤æŒ‰é’® */
    #runBtn {
      display: inline-block;
      padding: 12px 28px;
      font-size: 1rem;
      border: none;
      border-radius: 6px;
      background-color: #409eff;
      color: #fff;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }
    #runBtn:disabled {
      background-color: #a0bcd8;
      cursor: not-allowed;
    }
    #runBtn:hover:not(:disabled) {
      background-color: #357cd2;
    }
    /* è¾“å‡ºåŒºåŸŸ */
    #output {
      margin-top: 32px;
      /* è®©è¾“å‡ºä¸ instruction-section ç­‰å®½ï¼Œä½¿ç”¨ 100% å¡«å……çˆ¶å®¹å™¨å®½åº¦ */
      width: 100%;
      padding: 32px 0;            /* é¡¶éƒ¨/åº•éƒ¨ç•™äº›ç©ºé—´ï¼Œå·¦å³ç”±çˆ¶å®¹å™¨æ§åˆ¶ */
      background-color: #fafbfc;
      border-top: 1px solid #d1d9e0;
      border-bottom: 1px solid #d1d9e0;
      border-radius: 0 0 6px 6px;
      display: none;
    }
    #output .inner {
      width: 100%;
      padding: 0 40px;   /* ä¸ instruction-section å·¦å³å†…è¾¹è·ä¿æŒä¸€è‡´ */
      margin: 0 auto;
    }
    #output h3 {
      margin-bottom: 12px;
      font-size: 1.1rem;
      color: #2c3e50;
    }
    /* æ¸²æŸ“è¡¨æ ¼ */
    #output table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 16px;
    }
    #output th, #output td {
      border: 1px solid #d1d9e0;
      padding: 8px 12px;
      text-align: left;
    }
    #output th {
      background-color: #f1f3f5;
    }
    /* é¡µè„š */
    footer {
      width: 100%;
      background-color: #2c3e50;
      color: #dfe6eb;
      padding: 24px 40px; /* å·¦å³å†…è¾¹è·40 */
      text-align: center;
      margin-top: 40px;
    }
    footer a {
      color: #dfe6eb;
      margin: 0 12px;
      font-size: 0.95rem;
      transition: color 0.2s ease;
    }
    footer a:hover {
      color: #fff;
    }
    footer p {
      margin-bottom: 12px;
      font-size: 0.9rem;
    }
    /* å“åº”å¼å¤„ç†ï¼Œä¿è¯å°å±å¹•ä¸‹ä¹Ÿå¯ç”¨ */
    @media (max-width: 768px) {
      .features, .steps {
        flex-direction: column;
        align-items: center;
        padding: 0 20px;
      }
      .feature-card, .step-card {
        width: 100%;
        margin-top: 10px;
      }
      .hero {
        padding: 60px 20px;
      }
      .features {
        padding: 20px 20px;
      }
      .process {
        padding: 0 20px;
      }
      .instruction-section {
        width: 100%;
        padding: 32px 20px;
        margin: 20px 0;
      }
      #output .inner {
        padding: 0 20px;
      }
      footer {
        padding: 24px 20px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="top-nav">
      <div class="logo">AI</div>
      <h2>èˆ†æƒ…æ ‡ç­¾è‡ªåŠ¨åŒ–åˆ†ç±»æ™ºèƒ½ä½“</h2>
    </header>

    <!-- é¡¶éƒ¨å¤§æ¨ªå¹… -->
    <section class="hero">
      <h1>èˆ†æƒ…æ ‡ç­¾è‡ªåŠ¨åŒ–åˆ†ç±»</h1>
      <p>è‡ªåŠ¨æ ¹æ®ç”¨æˆ·æä¾›çš„å«èˆ†æƒ…æ–‡æœ¬çš„ Excel æ–‡ä»¶å’Œæ ‡ç­¾éœ€æ±‚ï¼Œå¯¹æ–‡æœ¬è¿›è¡Œè‡ªåŠ¨åŒ–åˆ†ç±»ï¼Œå¸®åŠ©ä¼ä¸šé«˜æ•ˆè·å–èˆ†è®ºæ ‡ç­¾å¹¶ä¼˜åŒ–å†³ç­–ã€‚</p>
      <div class="pill-buttons">
        <div class="pill"><span class="icon">ğŸ”</span>å†…å®¹è¯†åˆ«</div>
        <div class="pill"><span class="icon">âš¡</span>å¿«é€Ÿå“åº”</div>
        <div class="pill"><span class="icon">ğŸ¤–</span>AIæ™ºèƒ½</div>
        <div class="pill"><span class="icon">ğŸ“Š</span>ç»“æœå¯è§†åŒ–</div>
      </div>
    </section>

    <!-- åŠŸèƒ½ç‰¹è‰² -->
    <section class="features">
      <div class="feature-card">
        <div class="icon">ğŸ”</div>
        <h3>æ™ºèƒ½åˆ†æ</h3>
        <p>å¿«é€Ÿè§£æèˆ†æƒ…å†…å®¹ï¼Œç²¾å‡†å®šä½å…³é”®ä¿¡æ¯ã€‚</p>
      </div>
      <div class="feature-card">
        <div class="icon">âš¡</div>
        <h3>ç²¾ç¡®åˆ†ç±»</h3>
        <p>æ ¹æ®è‡ªå®šä¹‰æ ‡ç­¾ï¼Œè‡ªåŠ¨æ ‡æ³¨æ–‡æœ¬ï¼Œåˆ†ç±»æ•ˆæœç¨³å¥ã€‚</p>
      </div>
      <div class="feature-card">
        <div class="icon">ğŸš€</div>
        <h3>é«˜é€Ÿå¤„ç†</h3>
        <p>æ‰¹é‡å¤„ç†æµ·é‡æ•°æ®ï¼Œå¤§å¹…æå‡æ•ˆç‡ã€‚</p>
      </div>
      <div class="feature-card">
        <div class="icon">ğŸ¯</div>
        <h3>å¤šæ ‡ç­¾æ”¯æŒ</h3>
        <p>çµæ´»é…ç½®å¤šç§æ ‡ç­¾ï¼Œæ»¡è¶³å¤åˆåœºæ™¯éœ€æ±‚ã€‚</p>
      </div>
    </section>

    <!-- æµç¨‹å±•ç¤º -->
    <section class="process">
      <h2>èˆ†æƒ…åˆ†ç±»æµç¨‹</h2>
      <div class="steps">
        <div class="step-card">
          <div class="icon">ğŸ“¥</div>
          <h3>ä¸Šä¼  Excel æ–‡ä»¶</h3>
          <p>å°†å«èˆ†æƒ…å†…å®¹çš„ Excel æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿã€‚</p>
        </div>
        <div class="step-card">
          <div class="icon">ğŸ“</div>
          <h3>è¯†åˆ«ç”¨æˆ·æ ‡ç­¾</h3>
          <p>è§£æç”¨æˆ·è®¾ç½®çš„æ ‡ç­¾éœ€æ±‚ï¼Œå‡†å¤‡åˆ†ç±»è§„åˆ™ã€‚</p>
        </div>
        <div class="step-card">
          <div class="icon">ğŸ¤–</div>
          <h3>AIæ™ºèƒ½åˆ†ç±»</h3>
          <p>ä¾æ‰˜ AI æ¨¡å‹ï¼Œä¸ºæ–‡æœ¬è‡ªåŠ¨æ‰“ä¸Šæ ‡ç­¾ã€‚</p>
        </div>
        <div class="step-card">
          <div class="icon">âœ…</div>
          <h3>ç”Ÿæˆç»“æœ</h3>
          <p>å¯¼å‡ºå¸¦æ ‡ç­¾çš„ Excelï¼Œè½»æ¾è·å–åˆ†ç±»æŠ¥å‘Šã€‚</p>
        </div>
      </div>
    </section>

    <!-- ç”¨æˆ·æŒ‡ä»¤ä¸ä¸Šä¼ è¡¨å• -->
    <section class="instruction-section">
      <h2>å¼€å§‹è¿›è¡Œèˆ†æƒ…æ ‡ç­¾åˆ†ç±»</h2>
      <p class="subtitle">è¾“å…¥èˆ†æƒ…å†…å®¹å’Œæ ‡ç­¾ï¼Œè®©AIåŠ©æ‰‹å¸®ä½ è¿›è¡Œèˆ†æƒ…æ ‡ç­¾åˆ†ç±»</p>

      <!-- ç¤ºä¾‹æŒ‡ä»¤å±•ç¤º -->
      <div class="field">
        <label>ç”¨æˆ·æŒ‡ä»¤ç¤ºä¾‹ï¼š</label>
        <div class="example-container">
          <pre id="exampleText">æŒ‰ç…§å››ä¸ªæ–¹é¢è¿›è¡Œæ‰“æ ‡ç­¾ï¼Œ
1. äº§å“å£å‘³è¯„ä»·ï¼šå¥½è¯„ã€ä¸­è¯„ã€å·®è¯„
2. ç¯å¢ƒå’ŒæœåŠ¡è¯„ä»·ï¼šå¥½è¯„ã€ä¸­è¯„ã€å·®è¯„
3. å“ç‰ŒåŠè‚¡ç¥¨èµ„è®¯ï¼šæ˜¯ã€å¦
4. å“ç‰Œè¥é”€å®£ä¼ ï¼šæ˜¯ã€å¦</pre>
          <button class="copy-btn" id="copyExampleBtn">å¤åˆ¶ç¤ºä¾‹</button>
        </div>
      </div>

      <!-- ä¸Šä¼ æ–‡ä»¶ -->
      <div class="field">
        <label for="fileInput">ä¸Šä¼  .xlsx æ–‡ä»¶</label>
        <input type="file" id="fileInput" accept=".xlsx" />
      </div>
      <!-- ç”¨æˆ·æŒ‡ä»¤ -->
      <div class="field">
        <label for="instructionInput">ç”¨æˆ·æŒ‡ä»¤</label>
        <textarea id="instructionInput" rows="5" placeholder="è¯·åœ¨æ­¤è¾“å…¥è¦æ‰§è¡Œçš„æŒ‡ä»¤"></textarea>
      </div>
      <!-- è¾“å‡ºè¯­è¨€ -->
      <div class="field">
        <label for="langInput">è¾“å‡ºè¯­è¨€ï¼ˆå¯é€‰å¡«ï¼‰</label>
        <input type="text" id="langInput" placeholder="ä¾‹å¦‚ï¼šä¸­æ–‡ï¼Œç•™ç©ºåˆ™é»˜è®¤ä¸ºæ–‡æ¡£è¾“å…¥è¯­è¨€" />
      </div>
      <!-- æäº¤æŒ‰é’® -->
      <button id="runBtn">æ‰§è¡Œ</button>

      <!-- è¾“å‡ºåŒºåŸŸï¼Œä¸ instruction-section ç­‰å®½ -->
      <div id="output">
        <div class="inner">
          <!-- è¿™é‡Œä¼šæ’å…¥ â€œMarkdown è¡¨æ ¼æ¸²æŸ“â€ ç­‰å†…å®¹ -->
        </div>
      </div>
    </section>

    <!-- é¡µè„š -->
    <footer>
      <p>Â© 2025 AIæ ‡ç­¾åˆ†ç±»åŠ©æ‰‹ â€“ è®©èˆ†æƒ…åˆ†ææ›´ç®€å•</p>
      <div>
        <a href="#">ä½¿ç”¨æŒ‡å—</a>ï½œ  
        <a href="#">å¸¸è§é—®é¢˜</a>ï½œ  
        <a href="#">è”ç³»æˆ‘ä»¬</a>
      </div>
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    // å¤åˆ¶ç¤ºä¾‹æ–‡æœ¬åˆ°å‰ªè´´æ¿å¹¶å¡«å…¥æŒ‡ä»¤æ¡†
    document.getElementById('copyExampleBtn').addEventListener('click', () => {
      const exampleText = document.getElementById('exampleText').innerText.trim();
      navigator.clipboard.writeText(exampleText).then(() => {
        alert('ç¤ºä¾‹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
      });
      document.getElementById('instructionInput').value = exampleText;
    });

    // æ–‡ä»¶ä¸Šä¼ ä¸å·¥ä½œæµè°ƒç”¨é€»è¾‘
    const FILE_UPLOAD_URL = 'https://www.kofei.cc/v1/files/upload';
    const RUN_WORKFLOW_URL = 'https://www.kofei.cc/v1/workflows/run';
    const API_KEY = 'app-yTXPrjWxjb8iHKmu53K8akM4';

    const runBtn = document.getElementById('runBtn');
    const output = document.getElementById('output');
    const outputInner = document.querySelector('#output .inner');

    runBtn.addEventListener('click', async () => {
      const userId = (crypto.randomUUID && crypto.randomUUID()) || ('user_' + Date.now());
      const fileEl = document.getElementById('fileInput');
      const file = fileEl.files[0];
      const instruction = document.getElementById('instructionInput').value.trim();
      let lang = document.getElementById('langInput').value.trim();

      if (!file)        return alert('è¯·ä¸Šä¼  Excel æ–‡ä»¶');
      if (!instruction) return alert('è¯·è¾“å…¥ç”¨æˆ·æŒ‡ä»¤');
      if (!lang) lang = '';

      runBtn.disabled = true;
      output.style.display = 'none';
      outputInner.innerHTML = '';

      try {
        // åŒ…è£…æ–‡ä»¶åç§°ä¸ºçº¯ ASCII
        const asciiFile = new File([file], 'file.xlsx', { type: file.type });

        // ä¸Šä¼ æ–‡ä»¶
        runBtn.textContent = 'ä¸Šä¼ æ–‡ä»¶â€¦';
        const fd = new FormData();
        fd.append('file', asciiFile);
        fd.append('user', userId);
        fd.append('type', 'XLSX');

        const upRes = await fetch(FILE_UPLOAD_URL, {
          method: 'POST',
          headers: { 'Authorization': `Bearer ${API_KEY}` },
          body: fd
        });
        const upText = await upRes.text();
        let upJson;
        try { upJson = JSON.parse(upText); }
        catch { upJson = { raw: upText }; }

        if (!upRes.ok) {
          throw new Error(`æ–‡ä»¶ä¸Šä¼ å¤±è´¥ HTTP ${upRes.status}: ${upText}`);
        }

        const fileId = upJson.id || upJson.file_key || upJson.key;
        if (!fileId) throw new Error('ä¸Šä¼ æˆåŠŸä½†æœªè¿”å› fileId');

        // è°ƒç”¨å·¥ä½œæµ
        runBtn.textContent = 'è°ƒç”¨å·¥ä½œæµâ€¦';
        const inputs = {
          xlsx_format_input: {
            type: "document",
            transfer_method: "local_file",
            upload_file_id: fileId
          },
          user_instruction: instruction,
          language: lang
        };

        const payload = {
          inputs,
          response_mode: 'blocking',
          user: userId
        };

        const wfRes = await fetch(RUN_WORKFLOW_URL, {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${API_KEY}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(payload)
        });
        const wfText = await wfRes.text();
        let wfJson;
        try { wfJson = JSON.parse(wfText); }
        catch { wfJson = { raw: wfText }; }

        if (!wfRes.ok) {
          throw new Error(`è°ƒç”¨å·¥ä½œæµå¤±è´¥ HTTP ${wfRes.status}: ${wfText}`);
        }

        // æ¸²æŸ“ Markdown è¡¨æ ¼
        const markdownTable = wfJson.data.outputs.text || '';
        output.style.display = 'block';
        outputInner.innerHTML += '<h3>Markdown è¡¨æ ¼æ¸²æŸ“ï¼š</h3><div>' +
          marked.parse(markdownTable) +
          '</div>';
      } catch (err) {
        output.style.display = 'block';
        outputInner.innerHTML += '<h3>é”™è¯¯ä¿¡æ¯ï¼š</h3><pre>' + err.message + '</pre>';
      } finally {
        runBtn.disabled = false;
        runBtn.textContent = 'æ‰§è¡Œ';
      }
    });
  </script>
</body>
</html>
